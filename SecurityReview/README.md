| CIS Benchmark           | Control # | Control Text                                                                        | Result | Result Detail                                                                                                                                                                                                                      | Remediation                                                                                                                                                                                                                                                                                |
|-------------------------|-----------|-------------------------------------------------------------------------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Kubernetes v1.3.1       | 5.2.1     | Minimize the admission of privileged containers                                     | Fail   | Giftcard site PodSecurityPolicy fails the control. The policy should disallow privileged containers.                                                                                                                               | Revoke the permission that allows privileged containers in the appropriate PodSecurityPolicy and reapply the security policy with kubectl.                                                                                                                                                 |
| Kubernetes v1.3.1       | 5.2.2     | Minimize the admission of containers wishing to share the host process ID namespace | Fail   | Giftcard site PodSecurityPolicy fails the control. The policy should prevent sharing the host process ID namespace                                                                                                                 | Revoke the permission that allows sharing the host process ID namespace in the appropriate PodSecurityPolicy and reapply the security policy with kubectl.                                                                                                                                 |
| Kubernetes v1.3.1       | 5.2.3     | Minimize the admission of containers wishing to share the host IPC namespace        | Fail   | Giftcard site PodSecurityPolicy fails the control. The policy should prevent sharing the host IPC namespace                                                                                                                        | Revoke the permission that allows sharing the host IPC namespace in the appropriate PodSecurityPolicy and reapply the security policy with kubectl.                                                                                                                                        |
| Kubernetes v1.3.1       | 5.2.4     | Minimize the admission of containers wishing to share the host network namespace    | Pass   | This capability is not shared with containers by default and no pod security policy modifies the default setting                                                                                                                   | None                                                                                                                                                                                                                                                                                       |
| Kubernetes v1.3.1       | 5.2.5     | Minimize the admission of containers with allowPrivilegeEscalation                  | Fail   | Giftcard site PodSecurityPolicy fails the control. The policy should not allow privileged escalation                                                                                                                               | Revoke the permission that allows privilege escalation in the appropriate PodSecurityPolicy and reapply the security policy with kubectl.                                                                                                                                                  |
| Kubernetes v1.3.1       | 5.2.6     | Minimize the admission of root containers                                           | Fail   | Giftcard site PodSecurityPolicy fails the control. The policy should disallow privileged containers.                                                                                                                               | Revoke the permission that allows root containers in the appropriate PodSecurityPolicy and reapply the security policy with kubectl.                                                                                                                                                       |
| Kubernetes v1.3.1       | 5.2.7     | Minimize the admission of containers with the NET_RAW capability                    | Pass   | This capability is not shared with containers by default and no pod security policy modifies the default setting                                                                                                                   | None                                                                                                                                                                                                                                                                                       |
| Kubernetes v1.3.1       | 5.4.1     | Prefer using secrets as files over secrets as environment variables                 | Fail   | Secrets are littered through various locations in the Giftcard site and MySQL dockerfile. Preferably secrets should be stored in a file, but storing secrets in enviroment variables using Kubernetes Secrets is acceptable.       | Create kubernetes yaml file that stores the relavant secrets for each pod as applicable. Remove secrets from the Web application (limited to views.py and settings.py) needed to use the passed secrets. Apply the changes using kubectl and ensure the application still works correctly. |
| Kubernetes v1.3.1       | 5.7.1     | Create administrative boundaries between resources using namespaces                 | Fail   | No namespaces are currently implemented for the deployments in the cluster. Related resources in the cluster should share a namespace.                                                                                             | Implement namespaces in each of the kubernetes yaml files and apply the changes with kubectl. Ensure no errors are thrown by the pods and ensure the application is still functional                                                                                                       |
| Kubernetes v1.3.1       | 5.7.2     | Ensure that the seccomp profile is set to docker/default in your pod definitions    | Fail   | No seccomp profile is set in pod definitions.                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                            |
| Docker v1.20            | 4.1       | Ensure that a user for the container has been created                               | Fail   | The Giftcard site, proxy and MySQL docker containers are all running as root. The Giftcard site and Proxy Dockerfiles create users but the user is never switched. Remediation should be performed on the Giftcard site and proxy. |                                                                                                                                                                                                                                                                                            |
| Docker v1.20            | 4.2       | Ensure that containers use only trusted base images                                 | Pass   | Each dockerfile is built off a high trust base image                                                                                                                                                                               |                                                                                                                                                                                                                                                                                            |
| Docker v1.20            | 4.3       | Ensure that unnecessary packages are not installed in the container                 | Fail   | Giftcard site dockerfile installs excessive packages                                                                                                                                                                               |                                                                                                                                                                                                                                                                                            |
| Docker v1.20            | 4.9       | Ensure that COPY is used instead of ADD in Dockerfiles                              | Pass   | COPY is used in all cases where files need to be added to the container.                                                                                                                                                           |                                                                                                                                                                                                                                                                                            |
| Docker v1.20            | 4.10      | Ensure secrets are not stored in Dockerfiles                                        | Fail   | Secrets are stored in the MySQL Dockerfile. Move the secrets to Kubernetes Secrets                                                                                                                                                 |                                                                                                                                                                                                                                                                                            |
| Oracle MySQL 8.0 v1.1.0 | 1.2       | Use Dedicated Least Privileged Account for MySQL Daemon/Service                     | Pass   | The Oracle MySQL docker image provisions a mysql user and runs the MySQL service with this user                                                                                                                                    |                                                                                                                                                                                                                                                                                            |
| Oracle MySQL 8.0 v1.1.0 | 2.3       | Dedicate the Machine Running MySQL                                                  | Pass   | The MySQL database is on a dedicated pod in the kubernetes cluster that performs no other functions                                                                                                                                |                                                                                                                                                                                                                                                                                            |
| Oracle MySQL 8.0 v1.1.0 | 2.7       | Ensure 'password_lifetime' is Less Than or Equal to '365'                           | Fail   | Password lifetime is set to 0, which means that the password will not expire                                                                                                                                                       |                                                                                                                                                                                                                                                                                            |
| Oracle MySQL 8.0 v1.1.0 | 2.9       | Ensure Password Resets Require Strong Passwords                                     | Fail   | Password history and password reuse interval are both set to 0.                                                                                                                                                                    |                                                                                                                                                                                                                                                                                            |
| Oracle MySQL 8.0 v1.1.0 | 4.2       | Ensure Example or Test Databases are Not Installed on Production Servers            | Pass   | No example or test databases exist on the server                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                            |      |
